!function(l){for(var a=0,t=["webkit","o","ms","moz",""],o=t.length,n=0;n<o&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];function u(n){n instanceof jQuery&&(n=n[0]);var i=n.getBoundingClientRect();return 0<=i.top&&0<=i.left&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)}function w(n){return n[Math.floor(Math.random()*n.length)]}function c(n,i){return Math.floor(Math.random()*(i-n+1))+n}window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var i=(new Date).getTime(),e=Math.max(0,16-(i-a)),t=window.setTimeout(function(){n(i+e)},e);return a=i+e,t}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)}),l.fn.prefixedEvent=function(n,i){for(var e=0;e<o;++e)t[e]||(n=n.toLowerCase()),el=this instanceof jQuery?this[0]:this,el.addEventListener(t[e]+n,i,!1);return this},l.fn.sakura=function(n,m){var s=""==this.selector?l("body"):this;m=l.extend({},{blowAnimations:["blow-soft-left","blow-medium-left","blow-soft-right","blow-medium-right"],className:"sakura",fallSpeed:1,maxSize:14,minSize:10,newOn:300,swayAnimations:["sway-0","sway-1","sway-2","sway-3","sway-4","sway-5","sway-6","sway-7","sway-8"]},m);if(void 0===n||"start"===n){s.css({"overflow-x":"hidden"});var d=function(){s.data("sakura-anim-id")&&setTimeout(function(){requestAnimationFrame(d)},m.newOn);var n=w(m.blowAnimations),i=w(m.swayAnimations),e=(.007*document.documentElement.clientHeight+Math.round(5*Math.random()))*m.fallSpeed,t="fall "+e+"s linear 0s 1, "+n+" "+((30<e?e:30)-20+c(0,20))+"s linear 0s infinite, "+i+" "+c(2,4)+"s linear 0s infinite",a=l('<div class="'+m.className+'" />'),o=c(m.minSize,m.maxSize),r=o-Math.floor(c(0,m.minSize)/3);a.prefixedEvent("AnimationEnd",function(){u(this)||l(this).remove()}).prefixedEvent("AnimationIteration",function(n){-1==l.inArray(n.animationName,m.blowAnimations)&&-1==l.inArray(n.animationName,m.swayAnimations)||u(this)||l(this).remove()}).css({"-webkit-animation":t,animation:t,"border-radius":c(m.maxSize,m.maxSize+Math.floor(10*Math.random()))+"px "+c(1,Math.floor(r/4))+"px",height:o+"px",left:Math.random()*document.documentElement.clientWidth-100+"px","margin-top":-(Math.floor(20*Math.random())+15)+"px",width:r+"px"}),s.append(a)};s.data("sakura-anim-id",requestAnimationFrame(d))}else if("stop"===n){var i=s.data("sakura-anim-id");i&&(cancelAnimationFrame(i),s.data("sakura-anim-id",null)),setTimeout(function(){l("."+m.className).remove()},m.newOn+50)}}}(jQuery);